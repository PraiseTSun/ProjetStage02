swagger: "2.0"
info:
  title: OSE Killer
  description: API pour une plateforme de gestion de stage
  version: 1.0.0
host: localhost:8080
schemes:
  - http
paths:
  /student/login:
    post:
      summary: Retourne le token de l'étudiant si valide.
      parameters:
        - in: body
          name: Paramètres
          description: Adresse courriel et mot de passe
          schema:
            type: object
            properties:
              email:
                type: string
              password:
                type: string
      produces:
        - application/json
      responses:
        201:
          description: Token
          schema:
            type: object
            properties:
              token:
                type: string
        403:
          description: Courriel et/ou mot de passe invalide
  /gestionnaire/login:
    post:
      summary: Retourne le token du gestionnaire si valide
      parameters:
        - in: body
          name: Paramètres
          description: Adresse courriel et mot de passe
          schema:
            type: object
            properties:
              email:
                type: string
              password:
                type: string
      produces:
        - application/json
      responses:
        201:
          description: Token
          schema:
            type: object
            properties:
              token:
                type: string
        403:
          description: Courriel et/ou mot de passe invalide
  /company/login:
    post:
      summary: Retourne le token de la compagnie si valide
      parameters:
        - in: body
          name: Paramètres
          description: Adresse courriel et mot de passe
          schema:
            type: object
            properties:
              email:
                type: string
              password:
                type: string
      produces:
        - application/json
      responses:
        201:
          description: Token
          schema:
            type: object
            properties:
              token:
                type: string
        403:
          description: Courriel et/ou mot de passe invalide
  /student:
    put:
      summary: Retour d'un DTO étudiant si le token est valide.
      parameters:
        - in: body
          name: Paramètres
          description: Token de l'étudiant
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: DTO de l'étudiant
          schema:
            type: object
            properties:
              firstName:
                type: string
              lastName:
                type: string
              email:
                type: string
              isConfirmed:
                type: boolean
              department:
                type: boolean
        403:
          description: Token invalide
        404:
          description: Courriel pas validé
  /gestionnaire:
    put:
      summary: Retour d'un DTO gestionnaire si le token est valide.
      parameters:
        - in: body
          name: Paramètres
          description: Token du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: DTO du gestionnaire
          schema:
            type: object
            properties:
              firstName:
                type: string
              lastName:
                type: string
              email:
                type: string
              isConfirmed:
                type: boolean
              department:
                type: boolean
        403:
          description: Token invalide
        404:
          description: Courriel pas validé
  /company:
    put:
      summary: Retour d'un DTO entreprise si le token est valide.
      parameters:
        - in: body
          name: Paramètres
          description: Token de la compagnie
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: DTO de l'entreprise
          schema:
            type: object
            properties:
              firstName:
                type: string
              lastName:
                type: string
              email:
                type: string
              isConfirmed:
                type: boolean
              department:
                type: boolean
        403:
          description: Token invalide
        404:
          description: Courriel pas validé
  /createStudent:
    post:
      summary: Crée un étudiant et envoie le courriel de confirmation
      parameters:
        - in: body
          name: Paramètres
          description: Objet contenant les informations de l'étudiant
          schema:
            type: object
            properties:
              firstName:
                type: string
              lastName:
                type: string
              email:
                type: string
              password:
                type: string
              department:
                type: string
      produces:
        - application/json
      responses:
        201:
          description: Ne retourne pas d'objet
        409:
          description: Message d'erreur
          schema:
            type: object
            properties:
              error:
                type: string
        500:
          description: Message d'erreur
          schema:
            type: object
            properties:
              error:
                type: string
  /createCompany:
    post:
      summary: Crée une compagnie et envoie le courriel de confirmation
      parameters:
        - in: body
          name: Paramètres
          description: Objet contenant les informations de la compagnie
          schema:
            type: object
            properties:
              name:
                type: string
              firstName:
                type: string
              lastName:
                type: string
              email:
                type: string
              password:
                type: string
              department:
                type: string
      produces:
        - application/json
      responses:
        201:
          description: Ne retourne pas d'objet
        409:
          description: Message d'erreur
          schema:
            type: object
            properties:
              error:
                type: string
        500:
          description: Message d'erreur
          schema:
            type: object
            properties:
              error:
                type: string
  /createGestionaire:
    post:
      summary: Crée un gestionnaire et envoie le courriel de confirmation
      parameters:
        - in: body
          name: Paramètres
          description: Objet contenant les informations du gestionnaire
          schema:
            type: object
            properties:
              firstName:
                type: string
              lastName:
                type: string
              email:
                type: string
              password:
                type: string
      produces:
        - application/json
      responses:
        201:
          description: Ne retourne pas d'objet
        409:
          description: Message d'erreur
          schema:
            type: object
            properties:
              error:
                type: string
        403:
          description: Token invalide
          schema:
            type: object
            properties:
              error:
                type: string
        500:
          description: Message d'erreur
          schema:
            type: object
            properties:
              error:
                type: string
  /confirmEmail/student/{id}:
    put:
      summary: Confirme le courriel d'un étudiant
      parameters:
        - in: path
          name: id
          description: id de l'étudiant
          type: string
          required: true
      produces:
        - application/json
      responses:
        201:
          description: Ne retourne pas d'objet
        404:
          description: Message d'erreur si etudiant non trouvé
          schema:
            type: object
            properties:
              error:
                type: string
        400:
          description: Message d'erreur si email expiré
          schema:
            type: object
            properties:
              error:
                type: string
  /confirmEmail/company/{id}:
    put:
      summary: Confirme le courriel d'une compagnie
      parameters:
        - in: path
          name: id
          description: id de la compagnie
          type: string
          required: true
      produces:
        - application/json
      responses:
        201:
          description: Ne retourne pas d'objet
        404:
          description: Message d'erreur si compagnie non trouvé
          schema:
            type: object
            properties:
              error:
                type: string
        400:
          description: Message d'erreur si email expiré
          schema:
            type: object
            properties:
              error:
                type: string
  /confirmEmail/gestionnaire/{id}:
    put:
      summary: Confirme le courriel d'un gestionnaire
      parameters:
        - in: path
          name: id
          description: id du gestionnaire
          type: string
          required: true
      produces:
        - application/json
      responses:
        201:
          description: Ne retourne pas d'objet
        404:
          description: Message d'erreur si gestionnaire non trouvé
          schema:
            type: object
            properties:
              error:
                type: string
        400:
          description: Message d'erreur si email expiré
          schema:
            type: object
            properties:
              error:
                type: string
  /createOffre:
    post:
      summary: Retour d'un DTO offre avec si le pdf et le token (Compagnie) est valide.
      parameters:
        - in: body
          name: Paramètres
          description: Nom de compagie department position heures par semaine, adresse et pdf
          schema:
            type: object
            properties:
              nomDeCompagie:
                type: string
              department:
                type: string
              position:
                type: string
              heurParSemaine:
                type: integer
              adresse:
                type: string
              token:
                type: string
              pdf:
                type: array
                items:
                  type: number

      produces:
        - application/json
      responses:
        200:
          description: Ne retourne rien
        403:
          description: Le token de la compagnie n'est pas valide
        404:
          description: Les champs ne peuvent pas être vide
          schema:
            type: object
            properties:
              error:
                type: string
  /validateCV/{studentId}:
    put:
      summary: Validé un cv par son l'id de l'étudiant (Gestionnaire seulement)
      parameters:
        - in: path
          name: studentId
          description: id de l'étudiant
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: CV validé
        403:
          description: Token invalide ou expiré
        404:
          description: Un étudiant avec ce id n'existe pas
  /refuseCV/{studentId}:
    put:
      summary: Refuse un cv par son l'id de l'étudiant (Gestionnaire seulement)
      parameters:
        - in: path
          name: studentId
          description: id de l'étudiant
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: CV refusé et enlevé de la BD
        403:
          description: Token invalide ou expiré
        404:
          description: Un étudiant avec ce id n'existe pas
  /unvalidatedCvStudents:
    put:
      summary: Recevoir la liste des étudiants avec des cvs non validés
      parameters:
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: Liste des étudiants avec des CVs non validé
          schema:
            type: array
            items:
              type: object
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                email:
                  type: string
                isConfirmed:
                  type: boolean
                department:
                  type: boolean
        403:
          description: Token invalide ou expiré
  /studentCv/{studentId}:
    put:
      summary: Recevoir le CV d'un étudiant
      parameters:
        - in: path
          name: studentId
          description: id de l'étudiant
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: Le byte-array du cv
          schema:
            type: object
            properties:
              data:
                type: array
                items:
                  type: number
        403:
          description: Token invalide ou expiré
        404:
          description: L'étudiant avec cet id n'existe pas
  /unvalidatedStudents:
    put:
      summary: Recevoir la listes des étudiants à valider
      parameters:
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: Liste des étudiants non validés
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: number
                firstName:
                  type: string
                lastName:
                  type: string
                email:
                  type: string
                isConfirmed:
                  type: boolean
                department:
                  type: string
                inscriptionTimestamp:
                  type: number
                emailConfirmed:
                  type: boolean
                cv:
                  type: array
                  items:
                    type: number
        403:
          description: Token invalide
  /unvalidatedCompanies:
    put:
      summary: Recevoir la listes des compagnies à valider
      parameters:
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: Liste des compagnies non validés
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: number
                firstName:
                  type: string
                lastName:
                  type: string
                email:
                  type: string
                isConfirmed:
                  type: boolean
                department:
                  type: string
                inscriptionTimestamp:
                  type: number
                emailConfirmed:
                  type: boolean
                companyName:
                  type: string
        403:
          description: Token invalide
  /removeStudent/{id}:
    put:
      summary: Supprime un étudiant (Doit avoir un token gestionnaire)
      parameters:
        - in: path
          name: id
          description: id de l'étudiant
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: L'étudiant a été supprimé
        403:
          description: Token invalide ou expiré
        404:
          description: L'étudiant avec cet id n'existe pas
  /removeCompany/{id}:
    put:
      summary: Supprime une compagnie (Doit avoir un token gestionnaire)
      parameters:
        - in: path
          name: id
          description: id de la compagnie
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: La compagnie a été supprimé
        403:
          description: Token invalide ou expiré
        404:
          description: La compagnie avec cet id n'existe pas
  /validateStudent/{id}:
    put:
      summary: Valide un étudiant (Doit avoir un token gestionnaire)
      parameters:
        - in: path
          name: id
          description: id de l'étudiant
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: L'étudiant a été validé
        403:
          description: Token invalide ou expiré
        404:
          description: L'étudiant avec cet id n'existe pas
  /validateCompany/{id}:
    put:
      summary: Valide une compagnie (Doit avoir un token gestionnaire)
      parameters:
        - in: path
          name: id
          description: id de la compagnie
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: La compagnie a été validé
        403:
          description: Token invalide ou expiré
        404:
          description: La compagnie avec cet id n'existe pas
  /unvalidatedOffers:
    put:
      summary: Recevoir la listes des offres à valider
      parameters:
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: Liste des offres non validés
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: number
                department:
                  type: string
                position:
                  type: string
                heureParSemaine:
                  type: string
                adresse:
                  type: boolean
        403:
          description: Token invalide
  /validateOffer/{id}:
    put:
      summary: Valide une offre (Doit avoir un token gestionnaire)
      parameters:
        - in: path
          name: id
          description: id de l'offre
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: L'offre a été validé
        403:
          description: Token invalide ou expiré
        404:
          description: L'offre avec cet id n'existe pas
  /removeOffer/{id}:
    put:
      summary: Supprime une offre (Doit avoir un token gestionnaire)
      parameters:
        - in: path
          name: id
          description: id de l'offre
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: L'offre a été supprimé
        403:
          description: Token invalide ou expiré
        404:
          description: L'offre avec cet id n'existe pas
  /uploadStudentCV:
    put:
      summary: Upload un cv (Doit avoir un token gestionnaire)
      parameters:
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string


      produces:
        - application/json
      responses:
        200:
          description: Le cv a été enregistré
          schema:
            type: object
            properties:
              id:
                type: number
              firstName:
                type: string
              lastName:
                type: string
              email:
                type: string
              isConfirmed:
                type: boolean
              department:
                type: string
              inscriptionTimestamp:
                type: number
              emailConfirmed:
                type: boolean
              cv:
                type: array
                items:
                  type: number
        403:
          description: Token invalide ou expiré
        404:
          description: L'étudiant avec ce cv n'existe pas
  /offerPDF/{id}:
    put:
      summary: Upload un cv (Doit avoir un token gestionnaire)
      parameters:
        - in: path
          name: id
          description: id de l'offre
          type: string
          required: true
        - in: body
          name: token
          description: Token valide du gestionnaire
          schema:
            type: object
            properties:
              token:
                type: string
      produces:
        - application/json
      responses:
        200:
          description: Le cv a été enregistré
          schema:
            type: array
            items:
              type: number
        403:
          description: Token invalide ou expiré
        404:
          description: L'étudiant avec ce cv n'existe pas
